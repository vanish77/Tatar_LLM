#!/bin/bash

# Скрипт для запуска полного пайплайна обучения татарской LLM

echo "=================================="
echo "Татарская LLM - Полный пайплайн"
echo "=================================="
echo ""

# Проверка Python
if ! command -v python &> /dev/null; then
    echo "? Python не найден. Установите Python 3.8+"
    exit 1
fi

echo "? Python найден: $(python --version)"
echo ""

# Шаг 1: Установка зависимостей
echo "?? Шаг 1/4: Установка зависимостей..."
pip install -q -r requirements.txt
if [ $? -eq 0 ]; then
    echo "? Зависимости установлены"
else
    echo "? Ошибка установки зависимостей"
    exit 1
fi
echo ""

# Шаг 2: Подготовка данных
echo "?? Шаг 2/4: Загрузка и подготовка данных..."
python 01_prepare_data.py
if [ $? -eq 0 ]; then
    echo "? Данные подготовлены"
else
    echo "? Ошибка подготовки данных"
    exit 1
fi
echo ""

# Шаг 3: Обучение токенизатора
echo "?? Шаг 3/4: Обучение токенизатора..."
python 02_train_tokenizer.py
if [ $? -eq 0 ]; then
    echo "? Токенизатор обучен"
else
    echo "? Ошибка обучения токенизатора"
    exit 1
fi
echo ""

# Шаг 4: Обучение модели
echo "?? Шаг 4/4: Обучение модели..."
echo "??  Это может занять длительное время..."
python 03_train.py
if [ $? -eq 0 ]; then
    echo "? Модель обучена"
else
    echo "? Ошибка обучения модели"
    exit 1
fi
echo ""

echo "=================================="
echo "? ПАЙПЛАЙН ЗАВЕРШЁН УСПЕШНО!"
echo "=================================="
echo ""
echo "?? Следующие шаги:"
echo "1. Откройте demo_inference.ipynb для тестирования"
echo "2. Или используйте модель программно из Python"
echo ""
echo "Файлы модели находятся в: models/"
echo "Токенизатор находится в: tokenizer/"


